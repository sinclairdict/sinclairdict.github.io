---
layout: post
title: VBA编程学习-录制宏
comments: true
tags:
  - VBA
date: 2022-02-25 10:27:43
---
Excel中的**宏**指可以通过调用，执行多个动作的VBA（Visual Basic for Applocation）代码；英文全称为macro-assemblers，指可以将一系列计算机指令作为一个能实现复杂要求程序;简写为macro，由宏观（macroscopical）引申翻译为宏。
<!--more-->
**录制宏**能将击键和鼠标单击操作翻译并存储为VBA代码，之后可以在需要时复现动作。按钮在Excel的「开发工具」选项卡中；
![](/assets/images/220225_1.jpg)

### 宏的录制
以如下表格为例，录制一个宏：
![](/assets/images/220225_2.jpg)

1. 选中A1单元格，点击选项卡中的「录制宏」，保存在当前工作簿，宏名、快捷键、说明可自定义；
![](/assets/images/220225_3.jpg)
2. 选中A5单元格，键入“统计”；
3. 选中B5单元格，键入“=COUNTA(B2:B4)”；
4. 点击选项卡中的「停止录制」。

至此，即可完成一个宏的录制。

### 宏的使用
选中任意单元格，在「开发工具」选项卡中打开「宏」，选中宏名，单机「执行」即可自动复现上述动作。
![](/assets/images/220225_4.jpg)

### 宏的代码
按下Alt+F11，还可以打开编辑器查看代码，在模块1中。
![](/assets/images/220225_5.jpg)

### 补充（绝对引用和相对引用）
上述例子中，在任意单元格执行宏时，动作会出现在固定的某个单元格中，这是因为采用了系统默认为的绝对引用；
选中Excel的「开发工具」选项卡中的「使用相对引用」按钮，重复上述录制宏步骤，完成的宏即为相对引用；
完成后，在不同单元格（如单元格D1）上执行该宏，会发现动作出现在了不同的位置，该位置是以起始单元格A1为原点，叠加录制宏时动作的方向（向上、向下、向左、向右）和距离，而复现的；

按下Alt+F11查看代码，可以看到绝对引用和相对引用之间代码的区别。
![](/assets/images/220225_6.jpg)